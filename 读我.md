# Vultr-Aliyun

**Vultr-Aliyun** æ˜¯ä¸€ä¸ªç”¨äºå‘¨æœŸæ€§æ£€æµ‹ [**Vultr**](https://www.vultr.com/) æœåŠ¡å™¨æ˜¯å¦downæ‰å¹¶ä¸”è‡ªåŠ¨é‡æ–°éƒ¨ç½²å’Œ [**é˜¿é‡Œäº‘**](https://wanwang.aliyun.com/domain/com/?spm=5176.10695662.1158081.1.4fde4234L5A46c) åŸŸåç»‘å®šçš„å‘½ä»¤è¡Œå·¥å…·

åŒ [**English Document**](https://github.com/Fantastic8/Vultr-Aliyun/blob/master/README.md).


## å…ˆğŸƒèµ·æ¥å†è¯´
ç®€å•ç²—æš´çš„è·‘ **Vultr-Aliyun** å°±ä¸€è¡Œï¼Œä½†å…¶å®ä½ ä¼šå‘ç°æ ¹æœ¬è·‘ä¸èµ·æ¥ï¼Œå› ä¸ºæ²¡æœ‰é…ç½®ç¯å¢ƒ:

```
python3 vultr.py
``` 

å¦‚æœä½ è·‘èµ·æ¥äº†å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¡¨æ ¼æ˜¾ç¤ºäº†ä½ çš„æ‰€æœ‰æ•°æ®åº“é‡Œçš„è®°å½•.

![Main Menu](https://raw.githubusercontent.com/Fantastic8/Vultr-Aliyun/master/images/main.png)

é€‰æ‹© ```13``` å¼€å§‹ç›‘æ§.

![Monitoring](https://raw.githubusercontent.com/Fantastic8/Vultr-Aliyun/master/images/monitoring.png)

ä½¿ç”¨ [**screen**](https://linux.die.net/man/1/screen) å°†ç¨‹åºæ”¾åœ¨åå°ğŸƒï¼Œè¿™æ ·ä½ SSHæ–­æ‰äº†ç¨‹åºä¹Ÿä¸ä¼šåœæ­¢ã€‚


## ä½ å‡­ä»€ä¹ˆè¿è¡Œæˆ‘çš„jioæœ¬
+ å‡­ä½ æœ‰ä¸€å°å›½å†…çš„ linux æœåŠ¡å™¨
+ å‡­ä½ æœ‰ Vultr çš„æœåŠ¡å™¨
+ å‡­ä½ æœ‰é˜¿é‡Œäº‘çš„åŸŸå
+ å‡­ä½ æœ‰é˜¿é‡Œäº‘çš„[**API**](https://helpcdn.aliyun.com/document_detail/53045.html?parentId=30347)
+ å‡­ä½ æœ‰[**Vultr API**](https://www.vultr.com/api/)

## jioæœ¬è¿è¡Œæ¡ä»¶
+ python3
+ mysql
+ pymysql
+ [Aliyun SDK](https://help.aliyun.com/document_detail/53090.html) 
+ [tcping](https://gist.github.com/cnDelbert/5fb06ccf10c19dbce3a7)

## ç°åœ¨å¯ä»¥å¼€å§‹å®‰è£…äº†

å®‰è£… Mysql

å®‰è£… [tcping](https://gist.github.com/cnDelbert/5fb06ccf10c19dbce3a7)

å®‰è£… python3:

```
sudo apt-get install python3
```

å®‰è£… pymysql

å®‰è£… Aliyun SDK:

```
sudo pip3 install aliyun-python-sdk-core-v3
```

ç”¨ git ä¸‹è½½ **Vultr-Aliyun** :

```
git clone https://github.com/Fantastic8/Vultr-Aliyun.git
```

## ç¯å¢ƒé…ç½®

é…ç½® **Mysql**:

1. åˆ›å»ºä¸€ä¸ªmysqlç”¨æˆ·
2. åˆ›å»ºä¸€ä¸ªä¸“ç”¨æ•°æ®åº“ **Vultr-Aliyun** ç»™å¤§ä½¬è…¾ä¸ªä½ç½®

é…ç½® **vultr.py** æ–‡ä»¶:

```
cd Vultr-Aliyun
vi vultr.py
```

ä¿®æ”¹ä»¥ä¸‹å†…å®¹:

```
MYSQL_USER = 'åˆšæ‰åˆ›å»ºçš„mysqlç”¨æˆ·å'
MYSQL_PASSWD = 'åˆšæ‰åˆ›å»ºçš„mysqlç”¨æˆ·åå¯†ç '
MYSQL_DB = 'åˆšæ‰åˆ›å»ºçš„mysql æ•°æ®åº“å'
VULTR_KEY = 'Vultr çš„ API KEY'
ALI_ACCESS_KEY_ID = 'Aliyun çš„ access key id'
ALI_ACCESS_KEY_SECRET = 'Aliyun çš„ access key secret'
client = AcsClient(ALI_ACCESS_KEY_ID, ALI_ACCESS_KEY_SECRET, 'cn-hangzhou')
DOMAIN_NAME = 'Aliyun åŸŸå'
logf_name = 'vultr.log' # æ—¥å¿—æ–‡ä»¶å

# æ£€æµ‹æ—¶é—´é—´éš”æœ€å¥½å¤§äº5åˆ†é’Ÿ
CHECK_INTERVAL_MAX = 10 # æœ€å¤§æ£€æµ‹æ—¶é—´ (åˆ†é’Ÿ)
CHECK_INTERVAL_MIN = 4  # æœ€å°æ£€æµ‹æ—¶é—´ (åˆ†é’Ÿ)
check_int = CHECK_INTERVAL_MAX
CHECK_PORT = '1010' # vultræœåŠ¡å™¨çš„ç«¯å£å·ï¼Œè¿™ä¸ªç«¯å£å·æ˜¯ç”¨äºå“åº”ä¸»æœºçš„tcpingï¼Œè¯·ç¡®ä¿è¿™ä¸ªç«¯å£æ˜¯æ‰“å¼€çš„ï¼Œä¸ç„¶tcpingä¸æˆåŠŸï¼Œç¨‹åºä¼šåˆ¤å®šè¿™ä¸ªæœåŠ¡å™¨æ­»ç¿˜ç¿˜äº†
```

é…ç½®å¥½å°±å¯ä»¥è·‘ç¨‹åºäº† **vultr.py**:

```
python3 vultr.py
```

### ä¸ºå•¥éœ€è¦Snapshot

å½“ä½ éƒ¨ç½²äº†ä¸€ä¸ªæœåŠ¡å™¨åœ¨ **vultr** ä¸Šï¼Œè¿™ä¸ªæœåŠ¡å™¨å¯èƒ½ä¼šè¢«å¢™æ‰ï¼Œä½ æ‡‚å¾—ï¼Œä¸ç„¶ä½ ä¹Ÿä¸ä¼šæ¥æ‰¾æˆ‘è¿™ä¸ªjioæœ¬ã€‚å½“ä½ æŠŠæ‰€æœ‰åœ¨æœåŠ¡å™¨ä¸Šè¯¥è¿è¡Œçš„æœåŠ¡éƒ½å¼€èµ·æ¥äº†ä»¥åï¼Œåˆ›å»ºä¸€ä¸ª **snapshot** ï¼Œä»¥åå½“ä½ çš„æœåŠ¡å™¨è¢«å¢™æ‰ä»¥åé‡æ–°éƒ¨ç½²çš„æœåŠ¡å™¨ä¼šæ¢å¤åˆ°è¿™ä¸ª **snapshot** çš„ä½ç½®ç»§ç»­è¿è¡Œã€‚


## æµç¨‹å›¾(æˆ‘ä¹±ç”»çš„)

![Structure](https://raw.githubusercontent.com/Fantastic8/Vultr-Aliyun/master/images/structure.png)

## å’‹ç”¨

è¯·ç§»æ­¥ [**å’‹ç”¨**](https://github.com/Fantastic8/Vultr-Aliyun/blob/master/usage/%E8%AF%BB%E6%88%91.md).

## æŠŠè¯è¯´åœ¨å‰å¤´
+ æ‰€æœ‰æ²¡æœ‰è¢«æ·»åŠ è¿›æ•°æ®åº“è®°å½•çš„VultræœåŠ¡å™¨éƒ½å°†ä¼šè¢« **åˆ é™¤** æ‰ï¼ï¼ï¼ï¼ï¼æ‰€ä»¥åœ¨è¿è¡Œå‰è¯·å°†æ‰€æœ‰æœåŠ¡å™¨åŠ å…¥ä½ çš„æ•°æ®åº“è®°å½•ä¸­ã€‚
+ è¯·å§æœåŠ¡å™¨ï¼Œsnapshotï¼Œé˜¿é‡Œäº‘åŸŸåè§£æè®°å½•éƒ½å‡†å¤‡å¥½å†æ¥æ·»åŠ æ•°æ®åº“è®°å½•å“ˆ
+ è¦åˆ é™¤æœåŠ¡å™¨æˆ–è€…snapshotæˆ–è€…é˜¿é‡Œäº‘åŸŸåè§£æè®°å½•ä¹‹å‰è¯·å…ˆåˆ é™¤æ‰  **chain record** 
+ æŸ¥çœ‹æŠ¥é”™è¯·ç§»æ­¥ **vultr.log**
+ é€šå¸¸æƒ…å†µä¸‹è¦æ£€æµ‹ä¸¤æ¬¡æ‰èƒ½å®Œå…¨ä¿®å¤ä¸€æ¡è®°å½•ï¼Œå› ä¸ºéœ€è¦ç­‰vultrçš„æœåŠ¡å™¨é‡æ–°éƒ¨ç½²


# å“ªä¸ªå†™çš„

+ [**æˆ‘**](https://github.com/Fantastic8)

